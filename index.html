<!DOCTYPE html>
<html lang="en">
<head>
	<title> Markx </title>
	<meta name="description" content="" />
	<meta name="author" content="Yoav Ram">
	<meta name="keywords" content="">
	<meta charset="UTF-8">
	<meta http-equiv="content-type" content="text/html; charset=UTF-8">
	<link rel="icon" type="image/ico" href="static/img/favicon.ico">

	<!-- Le style -->
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<link href="static/css/style.css" rel="stylesheet">
	<link href="static/css/editor.css" rel="stylesheet">
	<link href="static/css/bootstrap.min.css" rel="stylesheet">
	<link href="static/css/fonts.css" rel="stylesheet">
	<link href="static/css/codemirror.css" rel="stylesheet">
	<link href="static/css/codemirror-elegant.css" rel="stylesheet">
	
	<!-- google code prettifier http://code.google.com/p/google-code-prettify/ -->
	<script type="text/javascript" src="static/js/prettify.js"></script>
	<link href="static/css/prettify/tomorrow-night-light.css" rel="stylesheet" id="prettify-style">

	<!-- MathJax -->
	<script type="text/x-mathjax-config">
	<!-- Online Debugger: http://www.onemathematicalcat.org/MathJaxDocumentation/TeXSyntax.htm -->
	<!-- Doc: http://docs.mathjax.org/en/latest/output.html -->`
	MathJax.Hub.Config({  
		tex2jax: {inlineMath: [['$','$']]},          
		"HTML-CSS": { availableFonts: ["STIX", "TeX"], 
						linebreaks: { automatic: true },
						imageFont: null
		}
	});
	</script>
	<script type="text/javascript" src="static/js/mathjax/MathJax.js?config=TeX-AMS_HTML">
	<!--http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS_HTML"-->
	</script>

	<!-- Le JS -->
	<script type="text/javascript" src="static/js/jquery.min.js"></script>
	<script type="text/javascript" src="static/js/bootstrap.min.js"></script>	
	<script type="text/javascript" src="static/js/Markdown.Converter.js"></script>
	<script type="text/javascript" src="static/js/Markdown.Sanitizer.js"></script>
	<script type="text/javascript" src="static/js/underscore-min.js"></script>
	<script type="text/javascript" src="static/js/base64.js"></script>
	<script type="text/javascript" src="static/js/github.js"></script>
	<script type="text/javascript" src="static/js/BibTex.js"></script>
	<script type="text/javascript" src="static/js/codemirror.js"></script>
	<script type="text/javascript" src="static/js/codemirror-markdown.js"></script>
	<script type="text/javascript" src="static/js/markx.js"></script>

	
	

	<script type="text/javascript">
	window.onload = function() {
		$('[rel=tooltip]').tooltip({'toggle':'hover', 'placement':'bottom'});
	}
	</script>
</head>


<body  onload="prettyPrint()">

<div class="row-fluid">
	<!-- HEADER -->

	

<div class="row-fluid">
	<div class="span12" style="line-height: 40px;">
		<a class="brand" href="/" rel="tooltip" title="Karl Heinrich Marx, 1818 – 1883">
			<img class="img-rounded" src="static/img/karl-marx-160x40.png">
		</a>
		<div class="btn-toolbar" id="general-toolbar">
			<button href="#modal-github-signin" id="btn-github-signin-show" role="button" class="btn" data-toggle="modal" rel="tooltip" title="Sign in to GitHub">
				<i class="icon-github-2"></i>
			</button>
			<button id="btn-github-signout" class="btn" rel="tooltip" title="Sign out of GitHub" style="display: none;">
				<i class="icon-exit"></i>
			</button>	
			<button class="btn" id="btn-display-panels" rel="tooltip" title="Change display">
				<i class=" icon-screen"></i>
			</button>
			<button class="btn" href="#modal-md-file-input" id="btn-md-file-input-show" role="button" data-toggle="modal" rel="tooltip" title="Load a Markdown file">
				<i class="icon-upload-2"></i>
			</button>
			<div class="btn-group">
				<button class="btn dropdown-toggle" data-toggle="dropdown" rel="tooltip" title="Citations and Bibliography">
					<i class="icon-books"></i>
					<span class="caret"></span>
				</button>
				<ul class="dropdown-menu">
					<li><a href='#' id="btn-citations">
						Update citations
					</a></li>
					<li><a href="#modal-bib-file-input" id="btn-bib-file-input-show" role="button" data-toggle="modal" rel="tooltip" title="Choose a bibliography file">
						Load References from file
					</a></li>
					<li><a href="#" id="btn-bib-file-view" rel="tooltip" title="View the loaded references library">
						View reference library
					</a></li>
					<li><a href="#" id="btn-citations-view" rel="tooltip" title="View the current citation list">
						View citation list
					</a></li>						
				</ul>
			</div>
			<div class="btn-group">
				<button class="btn dropdown-toggle" data-toggle="dropdown" rel="tooltip" title="Download and Convert. May take up to a minute.">
					<i class="icon-download-2"></i>
					<span class="caret"></span>
				</button>
				<ul class="dropdown-menu">
					<li><a href='#' id="btn-download-md"  rel="tooltip" title="Download as Markdown">
						<i class="icon-file-css"></i> Markdown
					</a></li>
					<li><a href='#' id="btn-download-pdf"  rel="tooltip" title="Download as PDF">
						<i class="icon-file-pdf"></i> PDF
					</a></li>
					<li><a href='#' id="btn-download-docx"  rel="tooltip" title="Download as Word docx">
						<i class="icon-file-word"></i> Word
					</a></li>
					<li><a href='#' id="btn-download-latex"  rel="tooltip" title="Download as LaTeX">
						<i class="icon-file-css"></i> LaTeX
					</a></li>
					<li><a href='#' id="btn-download-epub"  rel="tooltip" title="Download as ePub. No images allowed.">
						<i class="icon-book"></i> ePub
					</a></li>
					<li><a href='#' id="btn-download-html" rel="tooltip" title="Download as HTML">
						<i class="icon-file-xml"></i> HTML
					</a></li>
					<li><a href='#' id="btn-download-bibtex" rel="tooltip" title="Download citations as BibTeX">
						<i class="icon-books"></i> BibTeX
					</a></li>
				</ul>
			</div>			
			<button class="btn" id="btn-converter" rel="tooltip" title="Toggle Markdown converters: Pandoc or Docverter">P</button>
			<div class="btn-group">
				<button class="btn dropdown-toggle" data-toggle="dropdown" rel="tooltip" title="Change code highlighting theme">
					<i class="icon-code"></i>
					<span class="caret"></span>
				</button>
				<ul class="dropdown-menu">
					
					<li><a href='#' class="btn-prettify">solarized-dark</a></li>
					
					<li><a href='#' class="btn-prettify">google-code-light</a></li>
					
					<li><a href='#' class="btn-prettify">hemisu-dark</a></li>
					
					<li><a href='#' class="btn-prettify">sons-of-obsidian-dark</a></li>
					
					<li><a href='#' class="btn-prettify">hemisu-light</a></li>
					
					<li><a href='#' class="btn-prettify">tomorrow-night-light</a></li>
					
					<li><a href='#' class="btn-prettify">vibrant-ink</a></li>
					
					<li><a href='#' class="btn-prettify">tomorrow-night-blue</a></li>
					
					<li><a href='#' class="btn-prettify">tomorrow-night-dark</a></li>
					
					<li><a href='#' class="btn-prettify">tomorrow-night-eighties</a></li>
					
					<li><a href='#' class="btn-prettify">github</a></li>
					
					<li><a href='#' class="btn-prettify">bootstrap-light</a></li>
					
					<li><a href='#' class="btn-prettify">solarized-light</a></li>
					
				</ul>
			</div>
			<button class="btn btn-inverse" id="word-counter" rel="tooltip" title="Word count" disabled>0</button>
			<button class="btn btn-inverse" id="char-counter" rel="tooltip" title="Character count (a-z, A-Z, 0-9)" disabled>0</button>
		</div>
		<div class="btn-toolbar" id="github-toolbar" style="display: none">
			<button class="btn" rel="tooltip" title="GitHub links"  style="margin: auto 5px" disabled><i class="icon-github-2"></i></button>
			<input class="input-small" type="text" id="user" placeholder="user" style="margin: auto 5px" disabled>
			<button class="btn" id="reload-repos" rel="tooltip" title="Reload repositories">
				<i class="icon-redo-2"></i>
			</button>
			<select class="input-medium" type="text" id="repo" style="margin: auto 5px">
			</select>
			<button class="btn" id="repo-ok" rel="tooltip" title="Open repository">
				<i class="icon-folder-open"></i>
			</button>
			<select class="input-medium" type="text" id="branch" style="margin: auto 5px">
			</select>
			<button id="branch-ok" class="btn" rel="tooltip" title="Open branch">
				<i class="icon-folder-open"></i>
			</button>		
			<select class="input-medium" type="text" id="path" placeholder="/path/to/file" style="margin: auto 5px">
			</select>

			<div class="btn-group">				
				<button class="btn" id="btn-pull" rel="tooltip" title="Pull file and load to editor">
					<i class="icon-cloud-download"></i>
				</button>
				<button class="btn" id="btn-commit-push" rel="tooltip" title="Commit file and push">
					<i class="icon-cloud-upload"></i>
				</button>
				<button class="btn" id="btn-pull-bib" rel="tooltip" title="Pull bibliography file and load to reference library">
					<i class="icon-book"></i>
				</button>
				<button class="btn" id="btn-new-file" rel="tooltip" title="Create new file">
					<i class="icon-file-4"></i>
				</button>
				<button class="btn" id="btn-file-history" rel="tooltip" title="View file history">
					<i class="icon-stack"></i>
				</button>
			</div>	
			<input class="input" type="text" id="commit-message" placeholder="Commit message: Fixed typos" style="margin: auto 5px">
		</div>
	</div>
</div>
</div>
<div class="row-fluid">
	<div class="alert alert-error span4" id="general-alert" style="display: none">
		<button type="button" class="close" onclick="$('#general-alert').hide()">&times;</button>
		<div id="general-alert-message">
		</div>
	</div>
</div>
<div class="row-fluid">
	<div class="alert alert-info span4" id="general-info" style="display: none">
		<button type="button" class="close" onclick="$('#general-info').hide()">&times;</button>
		<div id="general-info-message">
		</div>
	</div>
</div>
<!-- GitHub Sign in Modal -->
<div id="modal-github-signin" class="modal hide fade" tabindex="-1" role="dialog" aria-labelledby="modal-github-signin-label" aria-hidden="true">
  <div class="modal-header">
    <button type="button" class="close" id="btn-github-signin-close">×</button>
    <h3 id="modal-github-signin-label">
    	<i class="icon-enter" style="margin-bottom: 0"></i> &nbsp; Sign in to GitHub
    </h3>
  </div>
  

  <div class="modal-body">
  	<form class="form-inline">
         <input type="text" class="input-small" placeholder="Username" id="github-username">
         <input type="password" class="input-small" placeholder="Password" id="github-password">
         <span class="help-block">
          <small>
            Your username and password are never saved by <em>Markx</em>. <br>
            They are sent to <a href="http://github.com/">GitHub</a> directly from your browser via the javascript library <a href="https://github.com/michael/github">github.js</a>.
          </small>
        </span>
  </form>
</div>
<div class="modal-footer">
  <button class="btn" id="btn-github-signin-cancel"><i class="icon-close"></i>&nbsp; Cancel</button>
  <button class="btn btn-primary" id="btn-github-signin-submit" type="submit"><i class="icon-checkmark-2"></i>&nbsp; Sign in</button>
</div>
</div>
<script type="text/javascript">
$('#modal-github-signin').on('shown', function () {
  $('#github-username').focus();
});
$('#github-password').keyup(function(e) {
  if ($(this).is(':visible') && e.which == 13) {
    /* 13 is enter */
    $('#btn-github-signin-submit').trigger('click');
  }
})
</script>

<!--Bibliography file input Modal -->
<div id="modal-bib-file-input" class="modal hide fade" tabindex="-1" role="dialog" aria-labelledby="modal-bib-file-input-label" aria-hidden="true">
  <div class="modal-header">
    <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
    <h3 id="modal-bib-file-input-label">
    	<i class="icon-book"></i> &nbsp; Choose a Bibliography File
    </h3>
  </div>
  
  <div class="modal-body">
  	<form class="form-inline">
      <input type="file" id="bibtex-file"/>
      <span class="help-block">
      <small>
        Please provide your bibliography file in <a href="http://www.bibtex.org/" target="_blank">BibTeX</a> format.<br>
        Your file will <strong>not</strong> be uploaded to Markx and will parsed on your computer with <a href="http://sourceforge.net/projects/jsbibtex/" target="_blank">BibTex.js</a>.<br>
        If you don't have a BibTeX file you can download one <a href="https://raw.github.com/yoavram/markx/master/library.bib" target="_blank">from here</a> to use with the Markx demo.
      </small>
    </span>
  </form>
</div>
<div class="modal-footer">
  <button class="btn" data-dismiss="modal"><i class="icon-close"></i>&nbsp; Cancel</button>
  <button class="btn btn-primary" id="btn-bib-file-input-submit" data-dismiss="modal" type="submit"><i class="icon-checkmark-2"></i>&nbsp; Load</button>
</div>
</div>

<!--Markdown file input Modal -->
<div id="modal-md-file-input" class="modal hide fade" tabindex="-1" role="dialog" aria-labelledby="modal-md-file-input-label" aria-hidden="true">
  <div class="modal-header">
    <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
    <h3 id="modal-md-file-input-label">
    	<i class="icon-file"></i> &nbsp; Choose a Markdown File
    </h3>
  </div>
  
  <div class="modal-body">
  	<form class="form-inline">
      <input type="file" id="md-file"/>
      <span class="help-block">
      <small>
        Please provide your file in <a href="http://daringfireball.net/projects/markdown/" target="_blank">Markdown</a> format.<br>
      </small>
    </span>
  </form>
</div>
<div class="modal-footer">
  <button class="btn" data-dismiss="modal"><i class="icon-close"></i>&nbsp; Cancel</button>
  <button class="btn btn-primary" id="btn-md-file-input-submit" data-dismiss="modal" type="submit"><i class="icon-checkmark-2"></i>&nbsp; Load</button>
</div>
</div>

<!--Bibliography view -->
<div id="modal-bib-view" class="modal hide fade" tabindex="-1" role="dialog" aria-labelledby="modal-bib-view-label" aria-hidden="true">
  <div class="modal-header">
    <button type="button" class="close" id="bib-view-close" aria-hidden="true">&times;</button>
    <h3 id="modal-bib-file-input-label">
    	<i class="icon-book"></i> &nbsp; Bibliography
    </h3>
  </div>
  
  <div class="modal-body" id="div-bib-view">
  	
  </div>
  <div class="modal-footer">
  </div>
</div>

<script type="text/javascript">
  $('#bib-view-close').click(function() {
    $('#modal-bib-view').modal('hide');
    $('#div-bib-view').html('');
  });
</script>



</div>

	<!-- BODY -->	
	<div class="row-fluid">
		<div class="span6" id="left-panel">

			


<div class="wmd-panel" id="editor-panel">
	<div id="wmd-button-bar-second"></div>
	<textarea class="wmd-input" id="wmd-input-second">
#Pandoc Markdown写作规范

##写在前面

本文是远程集体写书的格式规范说明文档。考虑到不少作者，已熟悉Markdown格式，因此，特别撰写一份基于Pandoc Markdown的写作格式规范。

##语法导读

* [Pandoc’s Markdown 語法中文翻譯]

##标题

规范

 * 使用 Markdown 的标题格式 `# 一级标题文字`、`## 二级标题文字` 等来书写标题，毋需人工指定标题序号如 1、1.1 等。
 * 标题层次深度至多为四级。
 * 建议在 `#` 号后面添加一个半角空格。

技巧与帮助

* 可以直接使用Github在线编辑
* [Markdown语法说明]

##提示语

规范

* 本书仅使用`note`, `danger`, `error`, `important`, `tip`, `warning`（注意，危险，错误，重要，提示，警告）六种提示语
* 写法为在引用第一行，写： `**note**` 用来表示此段为提示的文本，再空一行后，开始写提示的正文，如下所示：


	&gt; **note**
	&gt;
	&gt; Marr，一个大牛。

检查了自定义生成的note、tip等的LaTex代码，优雅漂亮，如下：

    \begin{quote}
    \textbf{note}
    
    Marr，一个大牛。
    \end{quote}

##定义

规范

* 使用Term开头，空格，然后写定义。

        Term 1
        
        :   Definition 1
        
        Term 2 with *inline markup*
        
        :   Definition 2
        
                { some code, part of Definition 2 }
        
            Third paragraph of definition 2.

##数学公式

规范

* 统一使用LaTex输出数学公式，参见：[Pandoc数学一节]
* 使用`$`表示行内输出；使用`$$`表示显示模式输出：

示范：

- Inline mode $e=mc^2$
- Display mode: $$\frac{df(x)}{dt}=lim_{x \to 0}{\frac{f(x+h)-f(x)}{h}}$$

技巧与帮助

* LaTex数学公式，参见：[LaTeX/数学公式]

##图片

规范

* 图片在各章下面，分别建立`figures`目录保存图片；并在`figures`目录下面建立`big`目录，用以保存制图的源文件，如ppt、keynote、gephi等；
* 非矢量图片需300dpi及以上，以达到堪用的印刷品质，；
* 引用图片，统一使用 Markdown 的规范：`![图片标题](图片相对地址)`；
* 图片标题是否人工指定序号由写作者决定。如果打算人工指定，需按章定序，如如：`图16-1 社会网络分析结果示意图`；
* 图片地址写法为：`figures/small_world.png`，图片命名由英文、数字和下划线构成，不能包括空格、非英文字符。

##表格

规范

* 如无意外，使用pandoc简单表格；
* 可使用R包`pander`或其他RMarkdown输出表格。
* 表的命名方式，统一为: `表3-1 不同中心性测量指标之间的关系`

技巧与帮助

参考：[Pandoc简单表格]

##脚注

脚注用于表示参考文献之外的内容，如本章部分没涉及到的内容或者有争议的话题。

规范

* 在正文中，写脚注的地方，前后加空格，如：` 我们发现社会网络是由一个强大的（但大部分是无形的）的“秘书”统治 [^7] `
* 脚注统一写在参考文献之前,写完脚注了，才是参考文献。
* 注的开头，统一使用：`注：`的写法。

如：

	[^7]:注：作者此处秘书指的是第一章中“非正式网络的力量”一节介绍的ACME咨询公司的例子中所提到的秘书处。

##版本

规范

* RStudio当前最新版本，`0.97`
* R当前最新版本，`3.0`

##R代码

规范

* 在各章下面，创建`code`目录。然后，使用R包：`ProjectTemplate`创建本章的项目。如果本章都是同一个数据源，则创建为一个项目；如果数据源差异较大，则创建为不同项目。

技巧与帮助

* [ProjectTemplate教程]
* [ProjectTemplate]

##日常Github提交

规范

* 基于`Git Flow`
* 如果不熟悉`Git`与`Git Flow`，建议直接在线编辑、在线提交。

技巧与帮助

* [Git flow 备忘清单]
* [Git flow 開發流程]
* [Git-flow 使用笔记]

备注：如果是Windows下的朋友，也可以直接使用本在线编辑器，通过`signinToGithub`，登陆Github后，找到你的相应章节，提交即可。



##参考文献

规范

* 统一使用APA第6版格式输出引文与文末参考文献；
* 将每一章的参考文献保存在一个`bibtex`文件中；
* 推荐使用参考文献软件为`Zotero`或`Endnote`。
* Pandoc默认支持参考文献，请使用``参考文献``作为末尾标题。
* 参考文献写法是：`[@yangzhiping2001]`或者`[@__2003]`，@符号后面直接写bib文件的引用文献的唯一编号，如yangzhiping2001或者__2003 

示例：

bib文件的内容是：

	@article{yangzhiping2003,
		title = {试评卡尼曼经济心理学研究及其影响 [J]},
		volume = {26},
		number = {4},
		urldate = {2013-05-27},
		journal = {心理科学},
		author = {阳志平},
		year = {2003},
		pages = {724–726}
	}


引用键是：`yangzhiping2003`，那么，引用格式直接这么写：

	阳志平在`[@yangzhiping2001]` 、`[@yangzhiping2002]`、`[@yangzhiping200]`中写道。。。


技巧与帮助

在[EndNote]中，一个较好的习惯是，写完论文之后，借助于它的`Export Traveling Library`功能，将每篇论文的参考文献导出为一个新的Endnote文献管理库，如下图所示：

![image](http://www.yangzhiping.com/images/psy/endnote.png)

## 参考文献

请加载附件中的`ouyang.bib`文件，即会出来本文引用的参考文献。点击`Citations`=&gt; `Load a Bibliography file`


##其它有用链接

请参考：

* [Customizing Markdown Rendering]
* [RStuido Markdown]
* [StackOverFlow pandoc节点]
* [Try Pandoc]

[Pandoc’s Markdown 語法中文翻譯]:http://pages.tzengyuxio.me/pandoc/
[Markdown语法说明]:http://markdown.tw/
[ProjectTemplate教程]:http://projecttemplate.net/getting_started.html
[ProjectTemplate]:http://www.johnmyleswhite.com/notebook/2010/08/26/projecttemplate/
[EndNote]:http://www.endnote.com/
[Customizing Markdown Rendering]:http://www.rstudio.com/ide/docs/authoring/markdown_custom_rendering
[RStuido Markdown]:http://www.rstudio.com/ide/docs/authoring/using_markdown_equations
[StackOverFlow pandoc节点]:http://stackoverflow.com/tags/pandoc/hot
[Try Pandoc]:http://johnmacfarlane.net/pandoc/try/
[Git flow 备忘清单]:http://danielkummer.github.io/git-flow-cheatsheet/index.zh_CN.html
[Git flow 開發流程]:http://ihower.tw/blog/archives/5140
[Git-flow 使用笔记]:http://fann.im/blog/2012/03/12/git-flow-notes/
[ProjectTemplate教程]:http://projecttemplate.net/getting_started.html
[ProjectTemplate]:http://www.johnmyleswhite.com/notebook/2010/08/26/projecttemplate/
[Pandoc简单表格]:http://pages.tzengyuxio.me/pandoc/#簡單表格
[LaTeX/数学公式]:http://zh.wikibooks.org/zh-cn/LaTeX/%E6%95%B0%E5%AD%A6%E5%85%AC%E5%BC%8F
[Pandoc数学一节]:http://pages.tzengyuxio.me/pandoc/#數學

	</textarea>
</div>



		</div>
		<div class="span6" id="right-panel">
			
<div id="preview-panel">
	<div id="wmd-preview-second" class="wmd-panel wmd-preview"></div>
	<div id="bibtex_display" class="wmd-panel wmd-preview">
	</div>
</div>
<textarea id="bibtex_input" style="display:none;">
</textarea>
		
		</div>

	</div>

	<!-- FOOTER -->
	<div class="row-fluid">
		<div class="span10 offset1">
			<footer class="colophon"> 
				
<script type="text/javascript">
/* markdown editor */
var converter = initMarkdownConverter();
var editor = initMarkdownEditor();
updatePreview();
$('#btn-md-file-input-submit').click(readMdFile);

/* citations */
$("#btn-citations").click(updateCitations);
$('#btn-bib-file-input-submit').click(readBibFile);
$('#btn-bib-file-view').click(function() {
	viewCitations(bibtex);
});
$('#btn-citations-view').click(function() {
	viewCitations(citationList);
});

/* code highlighting stuff */
$(function() {
	$('.btn-prettify').click(function() {
		$('#prettify-style').attr('href','static/css/prettify/' + $(this).text() + '.css');
		prettyPrintOne();
	});
})
prettyPrintOne();

/* github api */
var github = null;
var user = null;
var repo = null;
var editorSha = null;

$(function() {
	$('#btn-github-signin-cancel').click(clearGithubSigninForm);

	$('#btn-github-signin-close').click(clearGithubSigninForm);

	$('#btn-github-signin-submit').click(function() {
		signinToGithub();
	});

	$('#btn-github-signout').click(function() {
		if (confirm("Realy sign out of GitHub?")) {
			signoutOfGithub();
		}
	});

	$('#reload-repos').click(function() {
		loadUserRepos($('#user').val());
	});

	$('#repo-ok').click( function() {
		var username = $('#user').val();
		var reponame = $('#repo').val();
		if (!username || !username.length) {
			alertMessage("Please login to GitHub");
			return false;
		}
		if (!reponame || !reponame.length) {
			alertMessage("Please choose a repository name");
			$('#repo').focus();
			return false;
		}
		loadRepoBranches(username, reponame);
	});

	$('#branch-ok').click(function() {
		if (!repo || repo==null) {
			alertMessage("Please load a repository");
			$('#repo-ok').focus();
			return false;
		}
		branchname = $('#branch').val();
		if (!branchname || !branchname.length) {
			alertMessage("Please choose a branch name");
			$('#branch').focus();
			return false;
		}
		loadBranchPaths(branchname);
	});


	$('#btn-pull').click(function() {
		var branchname = $('#branch').val();
		var filepath = $('#path').val();
		var text = $('#wmd-input-second').val();
		pullFromGithub(branchname, filepath, text);
	});

	$('#btn-pull-bib').click(function() {
		var branchname = $('#branch').val();
		var filepath = $('#path').val();
		pullBibFromGithub(branchname, filepath);
	});

	$('#btn-commit-push').click(function() {
		var branchname = $('#branch').val();
		var filepath = $('#path').val();
		var commit_msg = $('#commit-message').val();
		var text = getEditor();
		pushToGithub(branchname, filepath, commit_msg, text);
	});

	$('#btn-new-file').click(function() {
		var text = $('#wmd-input-second').val();
		if ($.trim(text).length) {
			if (!confirm("The contents of the editor panel will be removed, do you want to contine?")) {
				return false;
			}
		}
		var branchname = $('#branch').val();
		var filepath = prompt("Please choose a name for the new file:");
		if (_.some($('#path').children(), function(option) { return option.value == filepath })) {
			alertMessage("File " + filepath + " already exists");
			return false;
		}
		var commit_msg = $('#commit-message').val();
		if (!commit_msg || !commit_msg.length) {
			commit_msg = "Create empty file via Markx";
		}
		pushToGithub(branchname, filepath, commit_msg, '\n', function() {
			loadBranchPaths(branchname, function() {
				$('#path').val(filepath);
			});
		}, true);
		updateEditor('');
		document.title = _.last(filepath.split('/')) + " | Markx";
	});

	$('#btn-file-history').click(function() {
		var username = $('#user').val();
		var reponame = $('#repo').val();
		var branchname = $('#branch').val();
		var filepath = $('#path').val();
		if (!username || !reponame || !branchname || !filepath) {
			alertMessage("Please choose a repository, a branch and a file");
			return false;
		}
		var url = "https://github.com/"+username+"/"+reponame+"/commits/"+branchname+"/"+filepath;
		window.open(url,  '_newtab');
	});

	/* file conversion */
	$('#btn-download-md').click(function() {
		save('md', download);
	});
	$('#btn-download-bibtex').click(function() {
		save('bib', download);
	});
	$('#btn-download-pdf').click(function() {
		if (getConverter() == 'docverter') {
			save('pdf', download);
		} else { // pandoc
			
			save('latex', function(filename) {
				var filepath = window.location.protocol + "//" + window.location.host  + '/download/' + filename;
				window.open("http://latex.aslushnikov.com/compile?url=" + filepath, '_newtab');
			});
			
		}
	});
	$('#btn-download-docx').click(function() {
		save('docx', download);
	});
	$('#btn-download-latex').click(function() {
		save('latex', download);
	});
	$('#btn-download-epub').click(function() {
		save('epub', download);
	});
	$('#btn-download-html').click(function() {
		save('html', download);
	});
	$('#btn-converter').click(function() {
		if ($(this).text() == 'D') {			
			$(this).text('P');
		} else {
			$(this).text('D');
		}
	});
})
/* display */
var panelsDisplayStatus = 'dual';
$(function() {
	$('#btn-display-panels').click(panelsDisplay);
})
</script>





				<ul class="quick-links">
					<li> 
						<a rel="license" href="http://creativecommons.org/licenses/by-nc-sa/3.0/">
							<img alt="Creative Commons License" src="http://i.creativecommons.org/l/by-nc-sa/3.0/80x15.png">
						</a>
					</li>
					<li><a href="https://github.com/yoavram/markx">Markx</a></li>
					<li><a href="http://blog.getbootstrap.com/">Twitter Bootstrap</a></li>
					<li><a href="http://underscorejs.org/">Underscore.js</a></li>					
					<li><a href="http://keyamoon.com/icomoon/">IcoMoon - Free</a><li>
					<li><a href="http://codemirror.net/">CodeMirror</a></li>
					<li><a href="https://code.google.com/p/pagedown">PageDown</a></li>
					<li><a href="http://google-code-prettify.googlecode.com/">Google Code Prettifier</a></li>
					<li><a href="http://mathjax.org/">MathJax</a></li>
					<li><a href="http://sourceforge.net/projects/jsbibtex/">Javascript BibTeX Parser</a></li>
					<li><a href="https://github.com/michael/github">Github.js</a></li>
					<li><a href="http://python.org/">Python</a></li>
					<li><a href="http://flask.pocoo.org/">Flask</a></li>
					<li><a href="http://python-requests.org/">Requests</a></li>
					<li><a href="http://www.github.com/">GitHub</a></li>	
					<li><a href="http://daringfireball.net/projects/markdown/">Markdown</a></li>
					<li><a href="http://johnmacfarlane.net/pandoc">Pandoc</a></li>
					<li><a href="http://docverter.com/">Docverter</a></li>
					</ul>
				</footer>
			</div>
		</div>
	</body>
</html>